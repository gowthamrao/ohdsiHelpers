#' @export
createStateCohortDefinitionSet <- function() {
  stateNames <- dplyr::tibble(
    stateAbbreviation = c(
      "AK",
      "AL",
      "AR",
      "AZ",
      "CA",
      "CO",
      "CT",
      "DC",
      "DE",
      "FL",
      "GA",
      "HI",
      "IA",
      "ID",
      "IL",
      "IN",
      "KS",
      "KY",
      "LA",
      "MA",
      "MD",
      "ME",
      "MI",
      "MN",
      "MO",
      "MS",
      "MT",
      "NC",
      "ND",
      "NE",
      "NH",
      "NJ",
      "NM",
      "NV",
      "NY",
      "OH",
      "OK",
      "OR",
      "PA",
      "PR",
      "RI",
      "SC",
      "SD",
      "TN",
      "TX",
      "UT",
      "VA",
      "VT",
      "WA",
      "WI",
      "WV",
      "WY"
    ),
    stateConceptId = c(
      42046190,
      42046189,
      42046193,
      42046192,
      42046196,
      42046197,
      42046198,
      42046200,
      42046199,
      42046218,
      42046219,
      42046226,
      42046232,
      42046227,
      42046228,
      42046229,
      42046237,
      42046238,
      42046239,
      42046242,
      42046241,
      42046240,
      42046252,
      42046253,
      42046255,
      42046254,
      42046264,
      42046271,
      42046280,
      42046265,
      42046267,
      42046268,
      42046269,
      42046266,
      42046270,
      42046284,
      42046285,
      42046286,
      42046289,
      42046290,
      42046292,
      42046293,
      42046294,
      42046298,
      42046299,
      42046303,
      42046309,
      42046304,
      42046310,
      42046312,
      42046311,
      42046313
    ),
    stateConceptName = c(
      "Alaska",
      "Alabama",
      "Arkansas",
      "Arizona",
      "California",
      "Colorado",
      "Connecticut",
      "District of Columbia",
      "Delaware",
      "Florida",
      "Georgia",
      "Hawaii",
      "Iowa",
      "Idaho",
      "Illinois",
      "Indiana",
      "Kansas",
      "Kentucky",
      "Louisiana",
      "Massachusetts",
      "Maryland",
      "Maine",
      "Michigan",
      "Minnesota",
      "Missouri",
      "Mississippi",
      "Montana",
      "North Carolina",
      "North Dakota",
      "Nebraska",
      "New Hampshire",
      "New Jersey",
      "New Mexico",
      "Nevada",
      "New York",
      "Ohio",
      "Oklahoma",
      "Oregon",
      "Pennsylvania",
      "Puerto Rico",
      "Rhode Island",
      "South Carolina",
      "South Dakota",
      "Tennessee",
      "Texas",
      "Utah",
      "Virginia",
      "Vermont",
      "Washington",
      "Wisconsin",
      "West Virginia",
      "Wyoming"
    )
  )
  
  stateCohortDefinitionSet <- stateNames |>
    dplyr::mutate(
      cohortId = stateConceptId,
      cohortName = paste0(
        "belongs to US state of ",
        stateConceptName,
        " (",
        stateAbbreviation,
        ")"
      ),
      sql = OhdsiHelpers::getDummyCohortDefinitionSet()$sql,
      json = OhdsiHelpers::getDummyCohortDefinitionSet()$json
    ) |>
    dplyr::mutate(
      sql = paste0(
        "DELETE FROM @target_database_schema.@target_cohort_table where cohort_definition_id = ",
        .data$cohortId,
        ";
          INSERT INTO @target_database_schema.@target_cohort_table
                (cohort_definition_id, subject_id, cohort_start_date, cohort_end_date)
          select ",
        .data$cohortId,
        " as cohort_definition_id, 
            person_id subject_id, 
            min(observation_period_start_date) cohort_start_date, 
            min(observation_period_end_date) cohort_end_date
          FROM @cdm_database_schema.observation_period op
          INNER JOIN
          (
                SELECT DISTINCT p.person_id
                from @cdm_database_schema.person p
                inner join @cdm_database_schema.location l
                on p.location_id = l.location_id
                WHERE state = '",
        stateAbbreviation,
        "')
        GROUP BY person_id;"
      )
    ) |>
    dplyr::select(cohortId,
                  cohortName,
                  sql,
                  json) |>
    dplyr::mutate(stateCohorts = 1)
  
  return(stateCohortDefinitionSet)
}
